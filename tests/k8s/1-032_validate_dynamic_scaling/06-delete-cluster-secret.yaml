apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands:
  - command: sleep 30s
  - command: kubectl delete Secret cluster-2 cluster-3 cluster-4 cluster-5 cluster-6 -n $NAMESPACE
  # Sleep to allow resources to be completely deleted
  - command: sleep 30s
---
# Retrigger reconcilation of ArgoCD
apiVersion: argoproj.io/v1alpha1
kind: ArgoCD
metadata:
  name: argocd
  labels:
    xyz: abc
spec:
  controller:
    sharding:
      dynamicShardingEnabled: true
      minShards: 1
      maxShards: 3
      clustersPerShard: 1